<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Zella Store PWA Core</title>
  <style>
    body, html {
      margin: 0px;
      padding: 0px;
    }
    
    .header-top {
      box-shadow: 0 1px 6px rgb(32 33 36 / 28%);
      width: 100%;
      height: 48px;
    }
    
    .menuBtn {
      width: 48px;
      height: 48px;
      background: transparent;
      border: 0px;
      padding: 0px;
      margin: 0px;
    }
    
    .menuBtn:hover {
      background: #00000010;
    }
    
    .menuBtn:active {
      background: #00000030;
    }
  </style>
</head>
<body>
  <div id="headerPresenter" class="header-top">
    <button class="menuBtn">
      <svg viewBox="0 2 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" style="pointer-events: none;width: 24px;height: 24px;">
        <g>
          <path d="M21,7 H3 V6 h18 V6 z M21,12 H3 v1 h18 V11 z M21,18 H3 v1 h18 V17 z"/>
        </g>
      </svg>
    </button>
  </div>
  <div id="contentPresenter">
    
  </div>
<script>
  (()=>{
    
    function Card(str) {
      let btn = document.createElement("BUTTON");
      btn.innerText = str;
      return btn;
    }
    
    function Carosel() {
      let ot = document.createElement("DIV");
      let ir = document.createElement("DIV");
      ot.appendChild(ir);
      return { "$type":"Store.W10M.XAML.CaroselElement", "self":ot, "contentPresenter":ir, "appendChild":function (el) { return this.contentPresenter.appendChild(el); } };
    }
    
    reloadAllow = false;
    
    ZellaStore = {
    
      "internals":{
      
        "exec":function (sz) {
          return eval("(()=>{ return " + sz.toString() + "; })();");
        }
        ,
        "ListResults":function (list, container) {
          container.innerHTML = "";
          for(let carosel in list) {
            let ttl = document.createElement("H3");
            ttl.innerText = list[carosel].category;
            container.appendChild(ttl);
            let crsl = Carosel();
            container.appendChild(crsl.self);
            for(let item in list[carosel].searchlist) {
              crsl.appendChild(list[carosel].searchlist[item]);
            }
          }
        }
      },
      "API":{
      
        "Reload":function (arg) {
          if (reloadAllow) {
            if (arg != undefined && arg != null){
              console.error(arg);
            }
            location.reload();
          }
        }
        ,
        "PresentJSON":function (json) {
          let rt = ZellaStore.internals.exec(json);
          ZellaStore.internals.ListResults(rt.groups, document.getElementById("contentPresenter"));
        }
        ,
        "SearchFor":function (query) {
          var xhr = new XMLHttpRequest();
          xhr.open("GET", "/storefront/api/v0/search?q=" + encodeURI(query) + "&" + "devicefamily=" + "pwa.web_only" + "&" + "sid=" + 0 + "&" + "lid=" + 0, true);
          xhr.onload = function (e) {
            if (xhr.readyState === 4) {
              if (xhr.status === 200) {
                ZellaStore.API.PresentJSON(xhr.responseText);
              } else {
                ZellaStore.API.Reload(xhr.statusText);
              }
            }
          };
          xhr.onerror = function (e) {
            ZellaStore.API.Reload(e);
          };
          xhr.send(null);
        }
      }
    }
    
  })();
  
  ZellaStore.API.SearchFor("Test");
</script>
</body>
</html>
